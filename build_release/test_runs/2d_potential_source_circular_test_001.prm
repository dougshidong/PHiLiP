## Listing of Parameters
# ---------------------

set dimension = 2
set run_type = flow_simulation
set pde_type  = physics_model
set model_type = potential_source

subsection physics_model
  subsection potential_source
    set potential_flow_model = euler
  end
end

# DG formulation
set use_weak_form = true
set flux_nodes_type = GLL

# Note: this was added to turn off check_same_coords() -- has no other function when dim!=1
set use_periodic_bc = true

# numerical fluxes
set conv_num_flux = roe
set diss_num_flux = symm_internal_penalty

set solution_vtk_files_directory_name = /home/aidan/Codes/PHiLiP/build_release/test_runs/solution_files
set output_high_order_grid = false
set enable_higher_order_vtk_output = true

set overintegration = 0

#set sipg_penalty_factor = 20
set output_face_results_vtk = false

subsection euler
  set reference_length = 1.0
  set mach_infinity = 0.50
  set angle_of_attack = 1.0
end

subsection potential_source
  
  # Choose geometry used for potential source term
  set potential_source_geometry = circular_test

  # If true, includes the contribution of the viscous drag.
  set viscous_drag = true
  
  subsection trailing edge serrations

    # Distance between consecutive trailing edge serrations
    set trailing_edge_serration_frequency = 0.015

    # Half the length of trailing edge serrations
    set half_trailing_edge_serration_length = 0.015

    # Thickness of trailing edge serrations
    set trailing_edge_serration_thickness = 0.001

    # Effective length factor for trailing edge serrations
    set trailing_edge_serration_effective_length_factor = 0.5

    # Angle of trailing edge flap in degrees (gamma)
    set angle_of_serrations = 0.0

  end

  subsection circular test
    # Radius of circle
    set circle_radius = 1.0
  end

end

subsection linear solver
#set linear_solver_type = direct
  #set linear_solver_output = verbose
  subsection gmres options
    # Factor by which the diagonal of the matrix will be scaled, which
    # sometimes can help to get better preconditioners
    set ilut_atol                 = 1e-4

    # Amount of an absolute perturbation that will be added to the diagonal of
    # the matrix, which sometimes can help to get better preconditioners
    set ilut_rtol                 = 1.00001

    # relative size of elements which should be dropped when forming an
    # incomplete lu decomposition with threshold
    set ilut_drop                 = 0.0

    # Amount of additional fill-in elements besides the sparse matrix
    # structure
    set ilut_fill                 = 10

    # Linear residual tolerance for convergence of the linear system
    set linear_residual_tolerance = 1e-13

    # Maximum number of iterations for linear solver
    set max_iterations            = 2000

    # Number of iterations before restarting GMRES
    set restart_number            = 200

  end 
end

subsection ODE solver
  set output_solution_every_x_steps = 1
  # Maximum nonlinear solver iterations
  set nonlinear_max_iterations            = 2000

  # Nonlinear solver residual tolerance
  set nonlinear_steady_residual_tolerance = 1e-14

  # Explicit or implicit solverChoices are <explicit|implicit>.
  set ode_solver_type  = implicit
  set initial_time_step = 1e3             # reduce to capture initial behaviour
  set time_step_factor_residual = 15.0
  set time_step_factor_residual_exp = 2

  # Print every print_iteration_modulo iterations of the nonlinear solver
  set print_iteration_modulo              = 1

end

subsection flow_solver
  set flow_case_type = naca0012
  set steady_state = true
  set poly_degree = 1
  set steady_state_polynomial_ramping = false
  subsection grid
    set input_mesh_filename = /home/aidan/Codes/PHiLiP/build_release/test_runs/test_meshes/CartesianGrid01
    # set input_mesh_filename = /home/aidan/Codes/PHiLiP/build_release/tests/meshes/naca0012_hopw_ref4
    set grid_degree = 1
  end
end
